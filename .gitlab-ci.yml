image: xd009642/tarpaulin:0.12.2

stages:
    - test

test:
    stage: test
    before_script:
        - apt-get update && apt-get -y install libgtk-3-dev
    script:
        - cargo tarpaulin -o Html --coveralls $COVERALLS_TOKEN
    only:
        - master
        - merge_requests
    artifacts:
        paths:
            - target/tarpaulin/coverage.json
            - tarpaulin-report.html